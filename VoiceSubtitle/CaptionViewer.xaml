<UserControl x:Class="VoiceSubtitle.CaptionViewer"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="Windo"
             xmlns:local="clr-namespace:VoiceSubtitle"
             xmlns:Controls="http://metro.mahapps.com/winfx/xaml/controls"
             mc:Ignorable="d"
             DataContext="{Binding PlayerViewModel, Source={StaticResource Locator}}">
    <UserControl.Resources>

        <Style x:Key="PronounceListBoxItemStyle"
               TargetType="{x:Type ListViewItem}">

            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="Padding"
                    Value="4,1" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Stretch" />
            <Setter Property="VerticalContentAlignment"
                    Value="Stretch" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="BorderBrush"
                    Value="Transparent" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ListBoxItemStyle1"
               TargetType="{x:Type ListBoxItem}">
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="Padding"
                    Value="4,1" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Stretch" />
            <Setter Property="VerticalContentAlignment"
                    Value="Stretch" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="BorderBrush"
                    Value="Transparent" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <Border x:Name="Bd"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                            <StackPanel>
                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />

                                <StackPanel x:Name="detailGrid"
                                            Grid.Row="1"
                                            Visibility="Collapsed">
                                    <TextBlock Margin="0,10,0,0"
                                               Text="{Binding PrononciationSentence}"
                                               FontStyle="Italic"
                                               Foreground="#FF4F4F4F"
                                               FontSize="10.667" />
                                    <StackPanel Orientation="Horizontal"
                                                Margin="4">
                                        <Button Content="1"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="1" />
                                        <Button Content="2+"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="2" />
                                        <Button Content="3+"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="3" />
                                        <Button Content="5+"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="5" />
                                        <Button Content="10+"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="10" />
                                        <Button Content="20+"
                                                Width="60"
                                                Margin="3"
                                                Command="{Binding PlayerViewModel.Listen, Source={StaticResource Locator}}"
                                                CommandParameter="20" />
                                    </StackPanel>
                                    <ListView ItemsSource="{Binding Prononciations}"
                                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                              ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                              ScrollViewer.CanContentScroll="False"
                                              SelectionMode="Single"
                                              SelectionChanged="ListView_SelectionChanged"
                                              ItemContainerStyle="{StaticResource PronounceListBoxItemStyle}"
                                              Margin="0,20,0,0"
                                              Background="#22DEB887"
                                              Focusable="False"
                                              Foreground="#FF034564">

                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="8"
                                                            Orientation="Horizontal">

                                                    <TextBlock Grid.Row="0"
                                                               Margin="16,-5,10,5"
                                                               Text="{Binding Text}"
                                                               FontSize="14" />

                                                    <Button Content="UK"
                                                            IsHitTestVisible="True"
                                                            Margin="16,-5,10,5"
                                                            Command="{Binding PlayerViewModel.PlayVoice, Source={StaticResource Locator}}"
                                                            CommandParameter="{Binding UKVoiceLink}" />

                                                    <TextBlock Text="{Binding UK}"
                                                               FontSize="14"
                                                               Margin="0,-5,0,5" />

                                                    <Button Content="US"
                                                            Margin="20,-5,10,5"
                                                            Command="{Binding PlayerViewModel.PlayVoice, Source={StaticResource Locator}}"
                                                            CommandParameter="{Binding USVoiceLink}" />
                                                    <TextBlock Text="{Binding US}"
                                                               FontSize="14"
                                                               Margin="0,-5,0,5" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver"
                                               Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="#1F26A0DA" />
                                <Setter Property="BorderBrush"
                                        TargetName="Bd"
                                        Value="#a826A0Da" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="#2226A0DA" />
                                <Setter Property="BorderBrush"
                                        TargetName="Bd"
                                        Value="#FF26A0DA" />
                                <Setter Property="DataContext"
                                        TargetName="detailGrid"
                                        Value="{Binding PlayerViewModel.LanguageDetail, Source={StaticResource Locator}}" />

                                <Setter Property="Visibility"
                                        TargetName="detailGrid"
                                        Value="Visible" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="False" />
                                </MultiTrigger.Conditions>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <DataTemplate x:Key="DataTemplate1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid>
                    <TextBlock Text="{Binding Text}"
                               TextWrapping="Wrap" />
                </Grid>
            </Grid>
        </DataTemplate>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="25" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="2"
              Background="#FF0771A2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal"
                        VerticalAlignment="Center">
                <TextBlock Text="{Binding Status}"
                           Foreground="#FFE2E2E2"
                           Margin="20,0,0,0" />

                <TextBlock Text="{Binding SelectedPrimaryCaption.Text}"
                           Foreground="#FFE2E2E2"
                           Margin="20,0,0,0" />
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal"
                        VerticalAlignment="Center">

                <TextBlock Text="{Binding VideoName}"
                           Foreground="#FFF9F9F9"
                           Margin="0,0,20,0" />

                <TextBlock Text="{Binding  VideoViewModel.VideoStatus,Source={StaticResource Locator}}"
                           Foreground="#FFF9F9F9"
                           Margin="0,0,20,0" />
            </StackPanel>
        </Grid>
        <Border Background="#FF024F7C">
            <TextBlock Text="{Binding VideoName}"
                       FontSize="18"
                       HorizontalAlignment="Left"
                       Margin="30,8,8,8"
                       VerticalAlignment="Center"
                       Foreground="White" />
        </Border>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="6" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <GridSplitter Width="6"
                          Background="Gray"
                          Grid.Column="1"
                          HorizontalAlignment="Stretch"
                          d:IsHidden="True" />
            <Grid x:Name="primaryCaptionGrid">
            </Grid>

            <ListBox Grid.Column="0"
                     SelectionChanged="ScrollToSelected"
                     ItemsSource="{Binding PrimaryCaption}"
                     SelectedItem="{Binding SelectedPrimaryCaption}"
                     ItemContainerStyle="{DynamicResource ListBoxItemStyle1}"
                     ItemTemplate="{DynamicResource DataTemplate1}" />
            <Grid HorizontalAlignment="Right"
                  VerticalAlignment="Top"
                  Opacity="0.4"
                  Margin="0,0,20,0"
                  Background="#FF8F8F8F">
                <StackPanel Orientation="Horizontal"
                            Margin="5">
                    <TextBox x:Name="searchBox"
                             KeyDown="PrimarySearch_KeyDown"
                             MinWidth="120"
                             Controls:TextBoxHelper.SelectAllOnFocus="True"
                             Controls:TextBoxHelper.Watermark="Search..."
                             Controls:TextBoxHelper.ClearTextButton="True" />
                    <Button Command="{Binding SearchBack}"
                            CommandParameter="{Binding ElementName=searchBox,Path=Text}">
                        <Button.Content>
                            <Rectangle Fill="#FF006595"
                                       Height="13"
                                       Width="9">
                                <Rectangle.OpacityMask>
                                    <VisualBrush Visual="{StaticResource appbar_navigate_previous}" />
                                </Rectangle.OpacityMask>
                            </Rectangle>
                        </Button.Content>
                    </Button>
                    <Button Command="{Binding SearchNext}"
                            CommandParameter="{Binding ElementName=searchBox,Path=Text}">
                        <Button.Content>
                            <Rectangle Fill="#FF006595"
                                       Height="13"
                                       Width="9">
                                <Rectangle.OpacityMask>
                                    <VisualBrush Visual="{StaticResource appbar_navigate_next}" />
                                </Rectangle.OpacityMask>
                            </Rectangle>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </Grid>

            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition Height="6" />
                    <RowDefinition Height="300" />
                </Grid.RowDefinitions>
                <GridSplitter Height="6"
                              Grid.Row="1"
                              HorizontalContentAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Background="Gray">
                </GridSplitter>
                <ListBox Grid.Row="0"
                         SelectionChanged="ScrollToSelected"
                         ItemsSource="{Binding TranslateCaption}"
                         SelectedItem="{Binding SelectedTranslateCaption}" />
                <local:VideoViewer Grid.Row="2" />
            </Grid>
        </Grid>
    </Grid>
</UserControl>